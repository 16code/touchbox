!function(t){function e(e){return t.MSPointerEvent?"MSPointer"+e.charAt(9).toUpperCase()+e.substr(10):e}function n(t){return"[object Function]"===g.call(t)}function o(t){return"[object Array]"===g.call(t)}function i(t){return"undefined"==typeof t}function s(t){return"string"==typeof t}function r(){}function a(t,e){if(t&&e)if(o(t))for(var n=0,i=t.length;i>n&&e.call(null,t[n],n,t)!==!1;n++);else for(var s in t)if(e.call(null,s,t[s])===!1)break}function c(t,e){if(t&&e&&"object"==typeof e){var n,o,i;for(n in e)t[n]=e[n];if(y)for(o=y.length;o--;)i=y[o],e.hasOwnProperty(i)&&(t[i]=e[i])}return t}function l(e){var n,o=t.getComputedStyle(e)[C.transform];return o&&(n=o.match(/^matrix(3d)?(.*)$/i))&&n&&n[2]?parseInt(n[2].replace(/ /g,"").split(",")[n[1]?13:5],10):0}function h(){return t.innerHeight>t.innerWidth}function u(e,n){return function(){var o=x.call(arguments,0),i=h();e.lastOrientation!==i&&(e.lastOrientation=i,e.apply(n||t,o))}}function p(t,e,n){var o=this,i=function(){t.transitionTimer&&clearTimeout(t.transitionTimer),t.transitionTimer=null,t.removeEventListener(C.transitionEndEvent,s,!1)},s=function(){i(),n&&n.call(o)};i(),t.addEventListener(C.transitionEndEvent,s,!1),t.transitionTimer=setTimeout(s,e+50)}var d=t.document,v=t.navigator.userAgent.toLowerCase(),f="ontouchstart"in t,m=t.PointerEvent||t.MSPointerEvent,g=Object.prototype.toString,x=Array.prototype.slice,y=["hasOwnProperty","valueOf","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","constructor"],E={wp:function(){return-1!==v.indexOf("windows phone ")?/\bwindows phone (?:os )?([0-9.]+)/:-1!==v.indexOf("xblwp")?/\bxblwp([0-9.]+)/:-1!==v.indexOf("zunewp")?/\bzunewp([0-9.]+)/:/\bwindows phone/}().test(v),ios:function(){return/\bcpu(?: iphone)? os /.test(v)?/\bcpu(?: iphone)? os ([0-9._]+)/:-1!==v.indexOf("iph os ")?/\biph os ([0-9_]+)/:/\bios\b/}().test(v),android:function(){return-1!==v.indexOf("android")?/\bandroid[ \/-]?([0-9.x]+)?/:-1!==v.indexOf("adr")?-1!==v.indexOf("mqqbrowser")?/\badr[ ]\(linux; u; ([0-9.]+)?/:/\badr(?:[ ]([0-9.]+))?/:/\bandroid/}().test(v)},b=(E.wp||E.ios||E.android,function(){return{start:f?"touchstart":m?e("pointerdown"):"mousedown",move:f?"touchmove":m?e("pointermove"):"mousemove",end:f?"touchend":m?e("pointerup"):"mouseup",cancel:f?"touchcancel":m?e("pointercancel"):"mousecancel"}}()),C=function(){var t=d.createElement("div").style,e=function(){for(var e,n="webkitT,t,msT,MozT,OT".split(","),o=0,i=n.length;i>o;o++)if(e=n[o]+"ransform",e in t)return n[o].substr(0,n[o].length-1);return!1}(),n=e?"-"+e.toLowerCase()+"-":"",o=function(t){return""===e?t:(t=t.charAt(0).toUpperCase()+t.substr(1),e+t)},i=o("transform"),s=o("transition"),r=o("transitionProperty"),a=o("transitionDuration"),c=o("transformOrigin"),l=o("transitionTimingFunction"),h=o("transitionDelay"),u=function(){return"webkit"==e||"O"===e?e.toLowerCase()+"TransitionEnd":"transitionend"}(),p=o("animation"),v=o("animationName"),f=o("animationDuration"),m=o("animationTimingFunction"),g=o("animationDelay");return t=null,{propPrefix:e,cssPrefix:n,transform:i,transition:s,transitionProperty:r,transitionDuration:a,transformOrigin:c,transitionTimingFunction:l,transitionDelay:h,transitionEndEvent:u,animation:p,animationName:v,animationDuration:f,animationTimingFunction:m,animationDelay:g}}(),w=function(t,e){var n={itemSelector:"",active:0,loop:!1,animation:"flow",duration:400,lockScreen:"off",rotateBody:"",beforeSlide:r,onSlide:r,onResize:r,scope:this};t&&!e&&(e=t,t=null),t?(t=s(t)?d.querySelector(t):t,t.parentNode.style.overflow="hidden"):t=d.body,t.style.overflow="hidden",this.ct=t,this.options=c(n,e),this.initEvents(),this.onOrientationChange(),this.resize(),this.to(this.options.active,!0)};w.prototype={initEvents:function(){this.ct.addEventListener(b.start,this,!1),this.onOrientationChangeProxy=u(this.onOrientationChange,this),t.addEventListener("orientationchange",this.onOrientationChangeProxy,!1),t.addEventListener("resize",this.onOrientationChangeProxy,!1),t.addEventListener("resize",this,!1)},getItems:function(){var t=this.options.itemSelector;return x.call(t?this.ct.querySelectorAll(t):this.ct.children,0)},getItem:function(t){return this.getItems()[t]},getActive:function(){return this.getItems()[this.active]},getLength:function(){return this.getItems().length},getLast:function(){return this.getLength()-1},getContext:function(t){var e,n,o=this.getLast();return i(t)&&(t=this.active),e=t-1,n=t+1,0>e&&(e=this.options.loop?o:-1),n>o&&(n=this.options.loop?0:-1),{prev:e,next:n,active:t}},resize:function(e,n){e=e||t.innerWidth,n=n||t.innerHeight,this.ct.style.width=e+"px",this.ct.style.height=n+"px",a(x.call(this.getItems(),0),function(t){t.style.width=e+"px",t.style.height=n+"px"}),this.options.onResize&&this.options.onResize.call(this.options.scope,e,n)},onResize:function(){var e=t.innerWidth,n=t.innerHeight;(this.lastWidth!=e||this.lastHeight!=n)&&(this.lastWidth=e,this.lastHeight=n,this.resize(e,n))},onOrientationChange:function(){var t=this.options.lockScreen;if("off"!=t){var e=h(),n=this.getLockRotateEl();"landscape"==t&&e?n.style.display="":"portrait"!=t||e?(this.onResize(),n.style.display="none"):n.style.display=""}else this.onResize()},getLockRotateEl:function(){if(!this.lockRotateEl){var t=this.options.rotateBody,e="display:none;position:fixed;left:0;top:0;bottom:0;right:0;z-index:9999998;width:100%;height:100%;",o=d.createElement("div");o.id="touchBoxRotate",o.style.cssText=e,t&&(o.innerHTML=n(t)?t():t),d.body.appendChild(o),this.lockRotateEl=o}return this.lockRotateEl},getAnimation:function(){return w.animations[this.options.animation]},setItemShow:function(t,e,n,o){if(e>-1){var i=this.getItem(e),s=this.getAnimation();s.touchStart.call(this,t,e,n,o),i.style[C.transitionTimingFunction]="ease-in-out",i.style[C.transitionDuration]="0ms",i.style.display="block"}},setItemHide:function(t,e){if(t>-1){var n=this.getItem(t);n.style.display="none",n.style[C.transform]="translate3d("+e+"px,0px,0px)",n.style[C.transitionDuration]="0ms"}},onTouchStart:function(t){var e=this;if(e.sliding)return t.preventDefault(),void t.stopPropagation();e.ct.removeEventListener(b.move,e,!1),e.ct.removeEventListener(b.end,e,!1),e.ct.removeEventListener(b.cancel,e,!1),e.ct.addEventListener(b.move,e,!1),e.ct.addEventListener(b.end,e,!1),e.ct.addEventListener(b.cancel,e,!1),delete e.vertical;var n=t.touches?t.touches[0]:t,o=e.getContext(),i=e.ct.offsetHeight;o.prev>-1&&e.setItemShow("prev",o.prev,-i,o),o.next>-1&&e.setItemShow("next",o.next,i,o),e.setItemShow("active",o.active,0,o),e.touchCoords={},e.touchCoords.startX=n.pageX,e.touchCoords.startY=n.pageY,e.touchCoords.timeStamp=t.timeStamp},onTouchMove:function(t){var e=this;if(e.touchCoords&&!e.sliding){var n=t.touches?t.touches[0]:t;e.touchCoords.stopX=n.pageX,e.touchCoords.stopY=n.pageY;var o=e.touchCoords.startX-e.touchCoords.stopX,s=e.touchCoords.startY-e.touchCoords.stopY,r=Math.abs(o),a=Math.abs(s);if(i(e.vertical))0!==s&&(t.preventDefault(),t.stopPropagation());else{if(!(a>r))return e.vertical=!1,void delete e.touchCoords;e.vertical=!0,0!==s&&(t.preventDefault(),t.stopPropagation())}var c,l=e.getContext(),h=e.ct.offsetHeight;h>a&&(c=e.getAnimation(),l.prev>-1&&c.touchMove.call(e,"prev",l.prev,-h-s,l),(e.options.loop||0>s&&l.prev>-1||s>0&&l.next>-1)&&c.touchMove.call(e,"active",l.active,-s,l),l.next>-1&&c.touchMove.call(e,"next",l.next,h-s,l))}},onTouchEnd:function(t){var e=this;if(e.ct.removeEventListener(b.move,e,!1),e.ct.removeEventListener(b.end,e,!1),e.ct.removeEventListener(b.cancel,e,!1),e.touchCoords&&!e.sliding){var n,o=e.getContext(),i=e.ct.offsetHeight,s=Math.abs(e.touchCoords.startY-e.touchCoords.stopY);!isNaN(s)&&s>0&&(s>i&&(s=i),n=s>=80||t.timeStamp-e.touchCoords.timeStamp<200?e.touchCoords.startY>e.touchCoords.stopY&&o.next>-1?o.next:e.touchCoords.startY<e.touchCoords.stopY&&o.prev>-1?o.prev:o.active:o.active,n==o.active&&0===l(e.getItem(n))?(e.setItemHide(o.prev,-i),e.setItemHide(o.next,-i)):(e.setItemHide(e.touchCoords.startY>e.touchCoords.stopY?o.prev:o.next,-i),e.to(n,!1,!0)),delete e.touchCoords)}},to:function(t,e,n){var o=this;if(!o.sliding){var i,s,r=o.active,a=o.getLast(),c=o.ct.offsetHeight,h=o.getContext(),u=function(s){n||(s?o.setItemShow("prev",t,-c,h):o.setItemShow("next",t,c,h),i>-1&&o.setItemShow("active",i,0,h)),o.slide(i,t,s,e)};t>-1&&a>=t&&t!=r&&this.options.beforeSlide.call(this.options.scope,t,r)!==!1?(i=r,s=a>1?r>t&&a>r||t==a-1&&r==a||t==a&&0===r:r>t,u(s)):(l(o.getItem(r))>0?(i=h.prev,s=!1):(i=h.next,s=!0),t=r,u(s))}},slide:function(t,e,n,o){var i,s,r,a,c=this,h=c.ct.offsetHeight,u=c.options.duration,d="0ms",v=c.getAnimation();c.sliding=!0;var f=function(t,e){t.removeEventListener(C.transitionEndEvent,e,!1)},m=function(){i&&(f(i,m),i.style.position="absolute",i.style.display="none",i.style[C.transitionDuration]=d)},g=function(){clearTimeout(c.resetSlideTimeout),c.resetSlideTimeout=null,f(s,g),s.style.position="relative",s.style[C.transitionDuration]=d,c.lastActive=c.active,c.active=e,c.sliding=!1,c.options.onSlide.call(c.options.scope,e,c.lastActive)};t>-1&&(i=c.getItem(t)),s=c.getItem(e),r=l(s),a=o?0:v.duration?v.duration.call(c,i,s,t,e,n):Math.round(Math.abs(r)/h*u),i&&(f(i,m),i.style[C.transitionDuration]=a+"ms"),f(s,g),s.style[C.transitionDuration]=a+"ms",setTimeout(function(){o||(i&&p(i,a,m),p(s,a,g)),i&&v.touchEnd.call(c,"active",t,r>0?-h:h,n),v.touchEnd.call(c,r>0?"next":"prev",e,0,n),o?(m(),g()):c.resetSlideTimeout=setTimeout(function(){m(),g()},a+400)},E.android?50:10)},prev:function(){var t=this.getContext();return t.prev>-1?(this.to(t.prev),!0):!1},next:function(){var t=this.getContext();return t.next>-1?(this.to(t.next),!0):!1},handleEvent:function(t){switch(t.type){case b.start:this.onTouchStart(t);break;case b.move:this.onTouchMove(t);break;case b.end:case b.cancel:this.onTouchEnd(t);break;case"resize":this.onResize(t)}},destroy:function(){this.destroyed||(this.destroyed=!0,this.ct.removeEventListener(b.start,this,!1),this.ct.removeEventListener(b.move,this,!1),this.ct.removeEventListener(b.end,this,!1),this.ct.removeEventListener(b.cancel,this,!1),t.removeEventListener("orientationchange",this.onOrientationChangeProxy,!1),t.removeEventListener("resize",this.onOrientationChangeProxy,!1),t.removeEventListener("resize",this,!1),this.lockRotateEl&&(this.lockRotateEl.parentNode.removeChild(this.lockRotateEl),this.lockRotateEl=null),this.ct=null)}},w.animations={slide:{touchStart:function(t,e,n){var o=this.getItem(e);"prev"===t||"next"===t?(o.style.position="absolute",o.style.left="0",o.style.top="0",o.style.zIndex="11"):(o.style.position="relative",o.style.zIndex="12"),o.style[C.transform]="translate3d(0px,"+n+"px,0px)"},touchMove:function(t,e,n){var o=this.getItem(e);this.options.loop||(0===e&&n>0||e==this.getLast()&&0>n)&&(n/=4),o.style[C.transform]="translate3d(0px,"+n+"px,0px)"},touchEnd:function(t,e,n){var o=this.getItem(e);o.style[C.transform]="translate3d(0px,"+n+"px,0px)"}},flow:{touchStart:function(t,e,n){var o=this.getItem(e);"prev"===t?(o.style.position="absolute",o.style.left="0",o.style.top="0",o.style.zIndex="11",o.style[C.transform]="translate3d(0px,"+n/4+"px,0px)"):"next"===t?(o.style.position="absolute",o.style.left="0",o.style.top="0",o.style.zIndex="13",o.style[C.transform]="translate3d(0px,"+n+"px,0px)"):(o.style.position="relative",o.style.zIndex="12",o.style[C.transform]="translate3d(0px,"+n+"px,0px)")},touchMove:function(t,e,n,o){var i=this.getItem(e),s=l(this.getItem(o.active));"prev"===t?i.style[C.transform]="translate3d(0px,"+n/4+"px,0px)":"next"===t?i.style[C.transform]="translate3d(0px,"+n+"px,0px)":(s>0?this.options.loop||(0===e&&n>0||e==this.getLast()&&0>n)&&(n/=4):n/=4,i.style[C.transform]="translate3d(0px,"+n+"px,0px)")},touchEnd:function(t,e,n,o){var i=this.getItem(e);i.style[C.transform]=!o&&"active"===t&&0>n?"translate3d(0px,"+n/4+"px,0px)":"translate3d(0px,"+n+"px,0px)"},duration:function(t,e,n,o){var i,s=this.ct.offsetHeight,r=l(e),a=0;return t&&(a=l(t)),i=0>r&&(this.options.loop||o!==this.getLast())?s-Math.abs(a):Math.abs(r),Math.round(i/s*this.options.duration)}}},t.TouchBox=w}(window);